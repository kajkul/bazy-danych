1.1. SELECT AVG(pensja) FROM EMPLOYEE;
1.2. SELECT COUNT(*), AVG(pensja) FROM EMPLOYEE GROUP BY JOB_POSITION_ID;
1.3. SELECT DEPARTMENT_ID, AVG(YEAR(CURRENT_TIMESTAMP) - YEAR(BIRTH_DATE)) FROM EMPLOYEE WHERE BIRTH_DATE IS NOT NULL GROUP BY DEPARTMENT_ID;

--------------------------------------------------

2.1. SELECT DEPARTMENT_ID, SUM(pensja) as p FROM EMPLOYEE GROUP BY DEPARTMENT_ID ORDER BY p DESC;
2.2. SELECT AVG(pensja) as p, JOB_POSITION_ID FROM EMPLOYEE GROUP BY JOB_POSITION_ID HAVING COUNT(*) >= 3 AND p > 3000;
2.3. SELECT COUNT(DISTINCT pensja) as p, DEPARTMENT_ID FROM EMPLOYEE GROUP BY DEPARTMENT_ID HAVING COUNT(*) > 4 ORDER BY p;

--------------------------------------------------

3.2. SELECT d.department_name, COUNT(*) FROM DEPARTMENT as d LEFT JOIN EMPLOYEE as e ON e.DEPARTMENT_ID = d.DEPARTMENT_ID GROUP BY d.DEPARTMENT_ID, d.department_name;
3.3. SELECT d.department_name, GROUP_CONCAT(CONCAT(e.first_name, ' ', e.last_name) SEPARATOR ', ') as employees FROM DEPARTMENT as d LEFT JOIN EMPLOYEE as e ON e.DEPARTMENT_ID = d.DEPARTMENT_ID GROUP BY d.DEPARTMENT_ID, d.department_name; 

--------------------------------------------------

4.1. SELECT e.LAST_NAME, p.POSITION_NAME FROM EMPLOYEE as e NATURAL JOIN JOB_POSITION as p WHERE YEAR(e.BIRTH_DATE) BETWEEN 1990 AND 1999;
4.2. SELECT e.FIRST_NAME, e.LAST_NAME FROM EMPLOYEE as e NATURAL JOIN JOB_POSITION as p WHERE p.POSITION_NAME = 'Magazynier' ORDER BY e.BIRTH_DATE DESC LIMIT 5;
4.3. SELECT CONCAT(c1.SHORT_NAME, " - ", c2.SHORT_NAME) FROM CLIENT as c1 JOIN CLIENT as c2 ON c2.CLIENT_ID = c1.CLIENT_ID + 5;

--------------------------------------------------

5.1. SELECT p.POSITION_NAME, AVG(e.pensja) FROM JOB_POSITION as p LEFT JOIN EMPLOYEE as e ON e.JOB_POSITION_ID = p.JOB_POSITION_ID LEFT JOIN DEPARTMENT as d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID WHERE d.DEPARTMENT_NAME NOT IN ('IT', 'HR') GROUP BY p.JOB_POSITION_ID, p.POSITION_NAME HAVING COUNT(*) > 3;
5.2. SELECT p.POSITION_NAME, e.FIRST_NAME, e.LAST_NAME, MIN(e.BIRTH_DATE), MAX(e.birth_date), d.department_name FROM JOB_POSITION as p NATURAL JOIN EMPLOYEE as e JOIN DEPARTMENT as d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID GROUP BY p.JOB_POSITION_ID, p.position_name, d.DEPARTMENT_ID, d.department_name;
5.3.
SELECT 
    e.FIRST_NAME,
    e.LAST_NAME,
    p.POSITION_NAME,
    e.BIRTH_DATE,
    stats.min_date,
    stats.max_date,
    d.DEPARTMENT_NAME
FROM 
    EMPLOYEE AS e
    INNER JOIN JOB_POSITION p ON e.JOB_POSITION_ID = p.JOB_POSITION_ID
    INNER JOIN DEPARTMENT d ON e.DEPARTMENT_ID = d.DEPARTMENT_ID
    INNER JOIN (
        SELECT 
            JOB_POSITION_ID,
            MIN(BIRTH_DATE) AS min_date,
            MAX(BIRTH_DATE) AS max_date
        FROM EMPLOYEE
        GROUP BY JOB_POSITION_ID
    ) stats ON e.JOB_POSITION_ID = stats.JOB_POSITION_ID
ORDER BY 
    p.POSITION_NAME, 
    e.LAST_NAME, 
    e.FIRST_NAME;
