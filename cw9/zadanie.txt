1. SELECT CONCAT(e.FIRST_NAME, ' ', e.LAST_NAME), RANK() OVER (ORDER BY pensja DESC) FROM EMPLOYEE AS e;

2. SELECT CONCAT(e.FIRST_NAME, ' ', e.LAST_NAME), RANK() OVER (ORDER BY pensja DESC), SUM(pensja) OVER () FROM EMPLOYEE AS e;

3. 
    SELECT
      e.EMPLOYEE_NAME,
      e.LAST_NAME,
      SUM(p.AMOUNT * p.SELL_PRICE),
      RANK() OVER (ORDER BY COALESCE(SUM(p.AMOUNT * p.SELL_PRICE), 0) DESC) as r
    FROM EMPLOYEE AS e
    LEFT JOIN `ORDER` AS o ON o.EMPLOYEE_ID = e.EMPLOYEE_NAME
    LEFT JOIN ORDER_POSITION AS p ON p.ORDER_ID = o.ORDER_ID
    GROUP BY e.EMPLOYEE_NAME, e.LAST_NAME
    ORDER BY r, e.LAST_NAME;

4. 
    SELECT 
        e.LAST_NAME,
        pp.PRODUCT_NAME,
        pp.PURCHASE_PRICE,
        COUNT(*) OVER (PARTITION BY p.PRODUCT_ID, o.ORDER_DATE) AS sold_today,
        SUM(p.AMOUNT * p.SELL_PRICE) OVER (PARTITION BY p.PRODUCT_ID, o.ORDER_DATE) AS sold_today_sum,
        LAG(p.SELL_PRICE, 1) OVER (PARTITION BY p.PRODUCT_ID ORDER BY p.POSITION_ID) AS prev,
        LEAD(p.SELL_PRICE, 1) OVER (PARTITION BY p.PRODUCT_ID ORDER BY p.POSITION_ID) AS after
    FROM ORDER_POSITION AS p
    LEFT JOIN `ORDER` AS o ON o.ORDER_ID = p.ORDER_ID
    LEFT JOIN EMPLOYEE AS e ON e.EMPLOYEE_NAME = o.EMPLOYEE_ID
    LEFT JOIN PRODUCT AS pp ON pp.PRODUCT_ID = p.PRODUCT_ID
    ORDER BY p.POSITION_ID;

5.
    SELECT 
        pp.PRODUCT_NAME,
        p.SELL_PRICE AS price,
        SUM(p.AMOUNT * p.SELL_PRICE) OVER (PARTITION BY MONTH(o.ORDER_DATE)) AS monthly_total,
        SUM(p.AMOUNT * p.SELL_PRICE) OVER (PARTITION BY MONTH(o.ORDER_DATE) ORDER BY o.ORDER_DATE, p.POSITION_ID) AS running_total
    FROM ORDER_POSITION AS p
    LEFT JOIN `ORDER` AS o ON o.ORDER_ID = p.ORDER_ID
    LEFT JOIN PRODUCT AS pp ON pp.PRODUCT_ID = p.PRODUCT_ID
    ORDER BY o.ORDER_DATE, p. POSITION_ID;

6.
    SELECT
        c.CATEGORY_NAME,
        SUM(IF(MONTH(o.ORDER_DATE) = 1, op.SELL_PRICE * op.AMOUNT, 0)) as styczen,
        SUM(IF(MONTH(o.ORDER_DATE) = 2, op.SELL_PRICE * op.AMOUNT, 0)) as luty,
        SUM(IF(MONTH(o.ORDER_DATE) = 3, op.SELL_PRICE * op.AMOUNT, 0)) as marzec,
        SUM(IF(MONTH(o.ORDER_DATE) = 4, op.SELL_PRICE * op.AMOUNT, 0)) as kwiecien,
        ABS(
            SUM(IF(MONTH(o.ORDER_DATE) = 4, op.SELL_PRICE * op.AMOUNT, 0)) -
            SUM(IF(MONTH(o.ORDER_DATE) = 1, op.SELL_PRICE * op.AMOUNT, 0)) 
        ) AS styczne_kwiecien_diff
    FROM PRODUCT as p
    LEFT JOIN CATEGORY AS c ON c.CATEGORY_ID = p.CATEGORY_ID
    LEFT JOIN ORDER_POSITION AS op ON op.PRODUCT_ID = p.PRODUCT_ID
    LEFT JOIN `ORDER` AS o ON o.ORDER_ID = op.ORDER_ID
    GROUP BY c.CATEGORY_ID, c.CATEGORY_NAME;

7. 
    SELECT
        c. CATEGORY_NAME,
        p.PRODUCT_NAME,
        MIN(op.SELL_PRICE) OVER (PARTITION BY p.CATEGORY_ID) as 'min',
        MAX(op.SELL_PRICE) OVER (PARTITION BY p.CATEGORY_ID) as 'max',
        MAX(op.SELL_PRICE) OVER (PARTITION BY p.CATEGORY_ID) - 
        MIN(op.SELL_PRICE) OVER (PARTITION BY p.CATEGORY_ID) as 'diff'
    FROM PRODUCT as p
    LEFT JOIN CATEGORY AS c ON c.CATEGORY_ID = p.CATEGORY_ID
    LEFT JOIN ORDER_POSITION AS op ON op.PRODUCT_ID = p.PRODUCT_ID;

8. 
    SELECT
        p.PRODUCT_NAME,
        AVG(op.SELL_PRICE) OVER (
            PARTITION BY p.PRODUCT_ID
            ORDER BY o.ORDER_DATE
            ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING
        ) as running_avg
    FROM PRODUCT as p
    LEFT JOIN ORDER_POSITION AS op ON op.PRODUCT_ID = p.PRODUCT_ID
    LEFT JOIN `ORDER` AS o ON o.ORDER_ID = op.ORDER_ID;

9. 
    SELECT
        p.PRODUCT_NAME,
        c.CATEGORY_NAME,
        RANK() OVER (PARTITION BY p.CATEGORY_ID ORDER BY op.SELL_PRICE) as 'rank',
        ROW_NUMBER() OVER (PARTITION BY p.CATEGORY_ID ORDER BY op.SELL_PRICE) AS 'row_number',
        DENSE_RANK() OVER (PARTITION BY p.CATEGORY_ID ORDER BY op.SELL_PRICE) AS 'rank_dense'
    FROM PRODUCT as p
    LEFT JOIN CATEGORY AS c ON c.CATEGORY_ID = p.CATEGORY_ID
    LEFT JOIN ORDER_POSITION AS op ON op.PRODUCT_ID = p.PRODUCT_ID
    LEFT JOIN `ORDER` AS o ON o.ORDER_ID = op.ORDER_ID;

10. 
    SELECT
        e.LAST_NAME,
        p.PRODUCT_NAME,
        op.AMOUNT * op.SELL_PRICE as value,
        SUM(op.AMOUNT * op.SELL_PRICE)
            OVER (
                PARTITION BY o.EMPLOYEE_ID
                ORDER BY o.ORDER_DATE
            ) AS employee_sales,
        RANK() OVER (
            PARTITION BY o.EMPLOYEE_ID
            ORDER BY op.AMOUNT * op.SELL_PRICE DESC
        ) AS 'rank'
    FROM ORDER_POSITION AS op
    JOIN `ORDER` AS o ON op.ORDER_ID = o.ORDER_ID
    JOIN EMPLOYEE AS e ON o.EMPLOYEE_ID = e.EMPLOYEE_NAME
    JOIN PRODUCT AS p ON op.PRODUCT_ID = p.PRODUCT_ID;

11. 
    SELECT DISTINCT
        e.FIRST_NAME,
        e.LAST_NAME,
        p.POSITION_NAME
    FROM EMPLOYEE AS e
    JOIN `ORDER` AS o ON o.EMPLOYEE_ID = e.EMPLOYEE_NAME
    JOIN JOB_POSITION AS p ON e.JOB_POSITION_ID = p.JOB_POSITION_ID;
